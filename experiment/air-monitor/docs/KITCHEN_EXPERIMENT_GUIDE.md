# 厨房环境综合检测实验完整指南

## 📋 实验概述

本实验将在DHT11温湿度实验基础上，扩展为厨房环境综合检测系统，监测厨房在正常状态、做菜状态、抽油烟机开启/关闭时的多种环境参数变化。

**实验目标：**
- 监测厨房空气污染、燃气、温湿度、噪音等指标
- 对比不同状态下的数据变化（做菜前、做菜时、抽油烟机开/关）
- 分析烹饪活动对环境的影响
- 为改善厨房环境提供数据参考

---

## 🔬 监测指标清单

### 1. 核心指标（必测）
| 指标名称 | 正常范围 | 警戒值 | 危险值 | 测量方法 |
|---------|---------|--------|--------|---------|
| **温度** | 20-30°C | >35°C | >45°C | DHT22/BME280 |
| **湿度** | 40-70% | <30%或>80% | <20%或>90% | DHT22/BME280 |
| **PM2.5颗粒物** | 0-35 μg/m³ | 35-75 | >150 | PMS5003/GY-MCU6805 |
| **一氧化碳(CO)** | 0-9 ppm | 10-35 | >100 | MQ-7 |
| **二氧化碳(CO2)** | 400-1000 ppm | 1000-2000 | >5000 | MH-Z19B/MQ-135 |

### 2. 扩展指标（可选，根据预算）
| 指标名称 | 正常范围 | 警戒值 | 危险值 | 测量方法 |
|---------|---------|--------|--------|---------|
| **气压** | 960-1080 hPa | - | - | BME280 |
| **挥发性有机物(VOC)** | <0.6 mg/m³ | 0.6-1.0 | >1.0 | MQ-135 |
| **噪音** | <50 dB | 50-70 dB | >70 dB | KY-038声音传感器 |
| **光线强度** | - | - | - | 光敏电阻/LDR |
| **人体感应** | - | - | - | HC-SR501红外传感器 |

---

## 🛒 推荐传感器采购清单（实验用/性价比优先）

### 方案A：基础版本（约150元）- 推荐
适合入门实验，能监测核心指标

| 序号 | 传感器名称 | 型号/规格 | 参考价格 | 供应商 | 备注 |
|------|-----------|----------|---------|--------|------|
| 1 | 温湿度+气压传感器 | **BME280** (I2C) | ¥18 | 淘宝 | 同时测温度、湿度、气压，性价比极高 |
| 2 | PM2.5颗粒物传感器 | **PMS5003/GP2Y1010** | ¥25-60 | 淘宝 | PMS5003精度高，GP2Y1010价格低 |
| 3 | 多功能气体传感器 | **MQ-135** (模拟) | ¥8 | 淘宝 | 可测CO2、NH3、酒精等多种气体 |
| 4 | 一氧化碳传感器 | **MQ-7** (模拟) | ¥12 | 淘宝 | 需要预热，检测CO |
| 5 | 噪音传感器 | **KY-038** (数字) | ¥5 | 淘宝 | 简单的音量检测 |
| **小计** | | | **¥68-103** | | **推荐BME280+PMS5003+MQ-135组合** |

### 方案B：进阶版本（约280元）
精度更高，数据更全面

| 序号 | 传感器名称 | 型号/规格 | 参考价格 | 供应商 | 备注 |
|------|-----------|----------|---------|--------|------|
| 1 | 温湿度+气压传感器 | **BME280** | ¥18 | 淘宝 | - |
| 2 | PM2.5颗粒物传感器 | **PMS5003** | ¥45 | 淘宝 | 激光型，精度高 |
| 3 | 二氧化碳传感器 | **MH-Z19B** | ¥75 | 淘宝 | NDIR原理，精度高 |
| 4 | 一氧化碳传感器 | **MQ-7** | ¥12 | 淘宝 | - |
| 5 | 多功能气体传感器 | **MQ-135** | ¥8 | 淘宝 | VOC检测 |
| 6 | 声音传感器 | **MAX4466** | ¥12 | 淘宝 | 模拟输出 |
| 7 | 人体感应传感器 | **HC-SR501** | ¥6 | 淘宝 | 数字输出 |
| **小计** | | | **¥176** | | - |

### 必备配件清单（实验用）

| 序号 | 名称 | 规格 | 数量 | 参考价格 | 备注 |
|------|------|------|------|---------|------|
| 1 | 面包板 | 830孔 | 1个 | ¥5 | 主面包板 |
| 2 | 面包板 | 400孔 | 1个 | ¥3 | 辅助面包板 |
| 3 | 杜邦线 | 公对公 20cm | 40根 | ¥5 | 必须 |
| 4 | 杜邦线 | 公对母 20cm | 20根 | ¥5 | 连接传感器 |
| 5 | 电阻包 | 220Ω, 4.7kΩ, 10kΩ | 各10个 | ¥8 | 限流和上拉 |
| 6 | USB转TTL模块 | CH340/CP2102 | 1个 | ¥8 | 调试用（可选） |
| **小计** | | | | **¥34** | - |

### 推荐采购方案

**总预算：约120-150元（基础版）**

**核心传感器推荐：**
1. ✅ **BME280** - 温湿度气压三合一（¥18）- 必选
2. ✅ **MQ-135** - CO2/空气污染检测（¥8）- 推荐
3. ✅ **MQ-7** - 一氧化碳检测（¥12）- 推荐
4. ⭐ **PMS5003** - PM2.5检测（¥45）- 如果预算允许
5. 其他传感器按需添加

---

## 📐 系统架构

```
┌──────────────────────────────────────────┐
│          Arduino UNO R4 WiFi              │
│                                          │
│  ┌──────────────────────────────────┐   │
│  │  传感器采集层 (最多10个传感器)    │   │
│  │                                  │   │
│  │  D2:  DHT22/BME280 (I2C)         │   │
│  │  D3:  MQ-135 气体传感器           │   │
│  │  D4:  MQ-7  一氧化碳             │   │
│  │  D5:  KY-038 声音传感器          │   │
│  │  D6:  HC-SR501 人体感应          │   │
│  │  A0:  MQ-135模拟输出             │   │
│  │  A1:  MQ-7模拟输出               │   │
│  │  A2:  MAX4466模拟输出            │   │
│  │  +  其他传感器                   │   │
│  └──────────────────────────────────┘   │
│                                          │
│  WiFi通信模块 (WiFiS3)                   │
└────────────────┬─────────────────────────┘
                 │ HTTP POST
                 ▼
┌──────────────────────────────────────────┐
│    PC端 Python Flask Web服务器          │
│                                          │
│  - 接收传感器数据                        │
│  - SQLite数据存储                        │
│  - 提供RESTful API                       │
│  - 数据分析与告警                        │
└────────────────┬─────────────────────────┘
                 │ HTTP
                 ▼
┌──────────────────────────────────────────┐
│    移动端/PC浏览器                        │
│                                          │
│  - 实时数据展示                          │
│  - 历史数据图表                          │
│  - 多传感器对比                          │
│  - 告警信息提示                          │
└──────────────────────────────────────────┘
```

---

## 🔌 硬件接线方案（面包板+杜邦线）

### 接线总览图

```
Arduino UNO R4 WiFi                   传感器模块
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
5V              ──→    所有传感器VCC
GND             ──→    所有传感器GND

I2C总线:
SDA (A4)        ──→    BME280 SDA
SCL (A5)         ──→    BME280 SCL
                       (+ 上拉4.7kΩ到3.3V)

数字引脚:
D2              ──→    - (备用)
D3              ──→    MQ-135 DO (数字输出，可选)
D4              ──→    MQ-7   DO (数字输出，可选)
D5              ──→    KY-038 DO
D6              ──→    HC-SR501 OUT

模拟引脚:
A0              ──→    MQ-135 AO
A1              ──→    MQ-7   AO
A2              ──→    MAX4466 OUT (声音)
A3              ──→    - (备用)
```

### 详细接线说明

#### 1. BME280温湿度+气压传感器（I2C总线）

**优点：** 一个传感器测3个指标，节省引脚

| BME280引脚 | Arduino引脚 | 线序 | 备注 |
|-----------|------------|------|------|
| VCC | 3.3V | 红色 | 推荐3.3V供电，也可用5V |
| GND | GND | 黑色 | 共地 |
| SDA | A4/SDA | 黄色 | I2C数据线 |
| SCL | A5/SCL | 绿色 | I2C时钟线 |

**面包板布局：**
```
  Arduino        面包板轨道          BME280
  3.3V  ────────┬───────────> VCC
  GND   ────────┼───────────> GND
  SDA   ────────────────> SDA
  SCL   ────────────────> SCL

  注意：BME280需要4.7kΩ上拉电阻
  (SDA, SCL各自上拉到3.3V)
```

#### 2. MQ-135多气体传感器（模拟+数字）

**功能：** 检测CO2、NH3、酒精、烟雾等

| MQ-135引脚 | Arduino引脚 | 线序 | 备注 |
|-----------|------------|------|------|
| VCC | 5V | 红色 | 传感器加热需5V |
| GND | GND | 黑色 | 共地 |
| AO | A0 | 白色 | 模拟输出 |
| DO | D3 | 黄色 | 数字输出（可调阈值） |

**重要：** MQ-135需要预热1-2分钟才能稳定读数

#### 3. MQ-7一氧化碳传感器（模拟+数字）

**功能：** 专门检测一氧化碳CO

| MQ-7引脚 | Arduino引脚 | 线序 | 备注 |
|----------|------------|------|------|
| VCC | 5V | 红色 | 需要5V |
| GND | GND | 黑色 | 共地 |
| AO | A1 | 白色 | 模拟输出 |
| DO | D4 | 黄色 | 数字输出 |

**预热时间：** 至少30秒，建议1分钟

#### 4. KY-038声音传感器

**功能：** 检测噪音分贝

| KY-038引脚 | Arduino引脚 | 线序 | 备注 |
|-----------|------------|------|------|
| VCC | 5V | 红色 | - |
| GND | GND | 黑色 | - |
| AO | - | - | 不接（如果只用数字） |
| DO | D5 | 黄色 | 数字输出 |

#### 5. HC-SR501人体感应传感器（可选）

**功能：** 检测厨房是否有人活动

| HC-SR501引脚 | Arduino引脚 | 线序 | 备注 |
|-------------|------------|------|------|
| VCC | 5V | 红色 | - |
| GND | GND | 黑色 | - |
| OUT | D6 | 黄色 | 数字输出 |

### 面包板布局建议

```
面包板布局（从上面俯视）：

  Arduino UNO R4 WiFi
  ┌─────────────────┐
  │  USB Port       │
  │                 │
  │  GND 5V 3.3V   │
  └────────┬────────┘
           │
    [面包板布局]
  ┌──────────────────────────────────────┐
  │  红色轨道(正极)  │    蓝色轨道(负极)   │
  ├──────────────────────────────────────┤
  │ 5V→正极轨  │   3.3V→正极轨 │ 所有GND→负极轨│
  │  + 并联传感器VCC                     │
  │                                      │
  │  传感器排列：                        │
  │  [BME280]  [MQ-135]  [MQ-7]         │
  │  [KY-038]  [HC-SR501]                │
  │                                      │
  │  信号线从传感器引出到Arduino对应引脚  │
  └──────────────────────────────────────┘
```

**布局技巧：**
1. 在面包板的一端放置Arduino
2. 使用正极轨道连接所有传感器的VCC（5V或3.3V）
3. 使用负极轨道连接所有传感器的GND
4. 信号线根据功能分组：
   - I2C传感器（BME280）连接SDA/SCL
   - 模拟传感器连接A0-A3
   - 数字传感器连接D2-D13

---

## 💻 Arduino代码实现

### 库依赖安装

在Arduino IDE的"库管理器"中安装：

| 库名称 | 作者 | 用途 |
|--------|------|------|
| **Wire** | Arduino官方 | I2C通信 |
| **WiFiS3** | Arduino官方 | WiFi连接 |
| **Adafruit_BME280** | Adafruit | BME280传感器 |
| **Adafruit_Sensor** | Adafruit | 传感器统一接口 |
| **ArduinoGraphics** | Arduino官方 | LED矩阵显示 |
| **Arduino_LED_Matrix** | Arduino官方 | LED矩阵控制 |

**安装顺序：**
1. 先安装 Adafruit_Sensor
2. 再安装 Adafruit_BME280
3. 最后安装其他库

### 代码示例

参见下文提供的完整代码文件

---

## 📊 实验操作步骤

### 阶段1：硬件搭建（2小时）

**任务清单：**
- [ ] 将Arduino连接到面包板（固定在面包板一侧）
- [ ] 按照接线图连接所有传感器
- [ ] 检查所有连接牢固
- [ ] 检查电源线（5V/3.3V）连接正确
- [ ] 检查GND都连接到面包板负极轨道
- [ ] 给I2C总线添加4.7kΩ上拉电阻（BME280）

**检查清单：**
- ✅ 每个传感器都有电源（VCC→5V或3.3V）
- ✅ 每个传感器都接地（GND→GND）
- ✅ 信号线连接到正确的引脚
- ✅ 面包板上没有短路
- ✅ LED矩阵能正常显示

### 阶段2：代码测试（1小时）

**任务清单：**
- [ ] 上传基础测试代码
- [ ] 打开串口监视器（波特率115200）
- [ ] 逐个测试每个传感器
- [ ] 记录初始读数
- [ ] 确认LED矩阵显示正常

**测试方法：**
1. 先单独测试BME280：上传代码后查看温湿度数据
2. 再测试MQ-135：对着传感器呼气看CO2变化
3. 测试MQ-7：需要等待预热时间
4. 测试声音传感器：拍手或敲击桌面

### 阶段3：WiFi连接测试（30分钟）

**任务清单：**
- [ ] 修改WiFi密码（ssid和pass）
- [ ] 修改PC服务器IP地址
- [ ] 上传完整代码
- [ ] 确认WiFi连接成功
- [ ] 确认数据发送到服务器

### 阶段4：实验数据采集（3-4小时）

**场景1：正常状态**
- [ ] 厨房无人，抽油烟机关闭
- [ ] 采集数据30分钟
- [ ] 记录基础环境值

**场景2：轻度烹饪**
- [ ] 开小火煮水
- [ ] 不开抽油烟机
- [ ] 监测数据变化
- [ ] 记录PM2.5、CO、温湿度变化

**场景3：开启抽油烟机**
- [ ] 继续相同烹饪
- [ ] 打开抽油烟机
- [ ] 对比PM2.5、CO、温湿度变化
- [ ] 观察改善效果

**场景4：重度烹饪**
- [ ] 开大火炒菜
- [ ] 产生油烟
- [ ] 先不开抽油烟机，记录峰值
- [ ] 打开抽油烟机，记录下降趋势

### 阶段5：数据分析（1小时）

**任务：**
- [ ] 导出SQLite数据库数据
- [ ] 用Excel或Python分析数据
- [ ] 绘制趋势图表
- [ ] 对比不同场景的数据
- [ ] 写实验报告

---

## 📈 数据分析参考

### 正常基准值（参考）

| 指标 | 正常厨房 | 轻度烹饪 | 重度烹饪（无抽油烟机） | 重度烹饪（有抽油烟机） |
|------|---------|---------|---------------------|---------------------|
| 温度 | 20-25°C | 28-35°C | 35-45°C | 32-38°C |
| 湿度 | 40-60% | 60-75% | 75-90% | 60-70% |
| PM2.5 | 0-35 μg/m³ | 50-150 μg/m³ | >200 μg/m³ | 50-100 μg/m³ |
| CO | 0-9 ppm | 10-20 ppm | 30-60 ppm | 15-25 ppm |
| CO2 | 400-1000 | 1000-1500 | 1500-2500 | 1000-1400 |

### 数据记录表格

| 时间 | 场景 | 温度 | 湿度 | PM2.5 | CO | CO2 | 备注 |
|------|------|------|------|-------|----|-----|------|
| 00:00 | 正常 | - | - | - | - | - | - |
| 00:10 | 炒菜（无抽油烟机） | - | - | - | - | - | - |
| 00:15 | 炒菜（开启抽油烟机） | - | - | - | - | - | - |

---

## ⚠️ 重要注意事项

### 安全提醒
1. **传感器预热**：MQ系列传感器需要1-2分钟预热，否则读数不准
2. **电源容量**：Arduino UNO R4 WiFi通过USB供电，确保提供足够的电流（建议2A以上适配器）
3. **短路保护**：接线时断电操作，避免短路烧毁传感器
4. **传感器高度**：PM2.5传感器建议离地1.5米，与人体呼吸高度一致
5. **远离热源**：BME280等传感器距离炉灶至少30cm

### 常见问题

**Q1: MQ-135读数一直很高？**
A: MQ-135需要预热1-2分钟，室内环境中正常读数为200-400（模拟值0-1024），如有干扰可调整

**Q2: BME280读取失败？**
A: 检查I2C连接，确认SDA/SCL接线正确，尝试用`I2C_Scanner`扫描地址

**Q3: 数据跳跃太大？**
A: 对模拟传感器（MQ-135、MQ-7）添加简单的滑动平均滤波

**Q4: WiFi连接失败？**
A: 确保2.4GHz网络，检查密码正确，靠近路由器测试

---

## 🎯 实验成果

### 预期成果
1. ✅ 成功搭建多传感器监测系统
2. ✅ 采集至少4个不同场景的对比数据
3. ✅ 分析抽油烟机对空气质量的影响
4. ✅ 形成数据可视化报告

### 数据分析示例

**数据分析步骤：**
1. 导出SQLite数据到CSV
2. 用Python pandas或Excel分析
3. 对比不同场景的数据差异
4. 绘制时间序列图表
5. 计算改善率

**示例结论：**
- 抽油烟机开启时，PM2.5平均降低60%
- 炒菜时CO浓度最高可达XX ppm，需要及时通风
- 温度在开启抽油烟机后可降低3-5°C

---

## 📁 文件结构

```
kitchen-environment/
├── arduino/                          # Arduino代码
│   ├── kitchen_sensor_v1.ino        # 完整代码（见下文）
│   └── README.md                     # Arduino代码说明
├── python/                           # PC端Web服务器
│   ├── kitchen_web_server.py        # Flask服务器（基于现有sensor_web_server.py扩展）
│   └── templates/
│       └── kitchen.html             # Web界面（多传感器版）
├── docs/                             # 文档
│   ├── KITCHEN_EXPERIMENT_GUIDE.md  # 本文件
│   └── wiring_diagram.png          # 接线图（待补充）
├── data/                             # 实验数据
│   └── kitchen_data.db              # SQLite数据库
└── results/                          # 分析结果
    ├── data_export.csv              # 导出的数据
    └── analysis_report.pdf           # 分析报告
```

---

**创建日期**: 2025-01-XX
**版本**: v1.0
**状态**: ✅ 准备开始实验
