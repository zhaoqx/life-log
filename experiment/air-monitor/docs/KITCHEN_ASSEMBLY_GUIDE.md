# 厨房空气质量监测系统 - 组装指南

**版本**: v1.0  
**日期**: 2025-10-28  
**适用**: Arduino UNO R4 WiFi + 多传感器系统

---

## 📋 目录

1. [材料清单](#材料清单)
2. [硬件连接步骤](#硬件连接步骤)
3. [接线图示](#接线图示)
4. [Arduino代码配置](#arduino代码配置)
5. [Python服务器配置](#python服务器配置)
6. [测试验证](#测试验证)
7. [常见问题](#常见问题)

---

## 材料清单

### 核心硬件

| 序号 | 名称 | 数量 | 说明 |
|------|------|------|------|
| 1 | Arduino UNO R4 WiFi | 1 | 开发板，内置WiFi模块和LED矩阵 |
| 2 | DHT11温湿度传感器 | 1 | 数字传感器，测量温度和湿度 |
| 3 | MQ7一氧化碳传感器 | 1 | 模拟传感器，检测CO浓度 |
| 4 | MQ135空气质量传感器 | 1 | 模拟传感器，检测多种气体 |
| 5 | 声音传感器模块 | 1 | 模拟传感器，检测声音强度 |
| 6 | 面包板 | 1 | 用于电路连接 |
| 7 | 杜邦跳线 | 若干 | 公对公、公对母 |
| 8 | USB Type-C数据线 | 1 | 连接Arduino和电脑 |

### 软件环境

| 软件 | 版本 | 用途 |
|------|------|------|
| Arduino IDE | 2.0+ | Arduino代码开发和上传 |
| Python | 3.8+ | 运行Web服务器 |
| Flask | 2.0+ | Python Web框架 |
| Flask-CORS | - | 跨域支持 |

---

## 硬件连接步骤

### 第一步：准备工作

1. **检查所有组件**
   - ✅ 确认所有传感器完好无损
   - ✅ 检查Arduino开发板接口
   - ✅ 准备足够的跳线

2. **了解Arduino引脚**
   ```
   Arduino UNO R4 WiFi 引脚说明：
   - 5V: 电源正极（红色）
   - GND: 电源负极（黑色）
   - D2: 数字引脚2（DHT11数据线）
   - A0: 模拟引脚0（MQ7输出）
   - A1: 模拟引脚1（MQ135输出）
   - A2: 模拟引脚2（声音传感器输出）
   ```

### 第二步：连接DHT11温湿度传感器

**DHT11传感器引脚说明**：
- VCC: 电源正极（5V）
- GND: 电源负极
- DATA: 数据引脚
- NC: 不连接

**连接步骤**：
1. 将DHT11的 **VCC** 连接到 Arduino **5V**（红色跳线）
2. 将DHT11的 **GND** 连接到 Arduino **GND**（黑色跳线）
3. 将DHT11的 **DATA** 连接到 Arduino **D2**（黄色跳线）
4. NC引脚不连接

```
DHT11 传感器
    VCC ──────[红线]────── Arduino 5V
    GND ──────[黑线]────── Arduino GND
    DATA ─────[黄线]────── Arduino D2
    NC   ─────────────────  (不连接)
```

### 第三步：连接MQ7一氧化碳传感器

**MQ7传感器引脚说明**：
- VCC: 工作电压5V
- GND: 接地
- A0: 模拟输出
- D0: 数字输出（可选）

**连接步骤**：
1. 将MQ7的 **VCC** 连接到 Arduino **5V**（红色跳线）
2. 将MQ7的 **GND** 连接到 Arduino **GND**（黑色跳线）
3. 将MQ7的 **A0** 连接到 Arduino **A0**（灰色跳线）
4. D0引脚不连接（本项目不使用）

```
MQ7 传感器
    VCC ──────[红线]────── Arduino 5V
    GND ──────[黑线]────── Arduino GND
    A0  ──────[灰线]────── Arduino A0
    D0  ──────────────────  (不连接)
```

**⚠️ 重要提示**：
- MQ7传感器需要预热2-5分钟才能获得稳定读数
- 第一次使用建议预热24小时以获得最佳性能
- 传感器工作时会发热，这是正常现象

### 第四步：连接MQ135空气质量传感器

**MQ135传感器引脚说明**：
- VCC: 5V电源
- GND: 接地
- A0: 模拟输出
- D0: 数字输出（可选）

**连接步骤**：
1. 将MQ135的 **VCC** 连接到 Arduino **5V**（红色跳线）
2. 将MQ135的 **GND** 连接到 Arduino **GND**（黑色跳线）
3. 将MQ135的 **A0** 连接到 Arduino **A1**（绿色跳线）
4. D0引脚不连接

```
MQ135 传感器
    VCC ──────[红线]────── Arduino 5V
    GND ──────[黑线]────── Arduino GND
    A0  ──────[绿线]────── Arduino A1
    D0  ──────────────────  (不连接)
```

**⚠️ 重要提示**：
- MQ135对油烟、烟雾非常敏感
- 传感器也需要预热才能稳定
- 避免在传感器附近使用强烈气味的物品

### 第五步：连接声音传感器

**声音传感器引脚说明**：
- VCC: 5V电源
- GND: 接地
- OUT: 信号输出

**连接步骤**：
1. 将声音传感器的 **VCC** 连接到 Arduino **5V**（红色跳线）
2. 将声音传感器的 **GND** 连接到 Arduino **GND**（黑色跳线）
3. 将声音传感器的 **OUT** 连接到 Arduino **A2**（蓝色跳线）

```
声音传感器
    VCC ──────[红线]────── Arduino 5V
    GND ──────[黑线]────── Arduino GND
    OUT ──────[蓝线]────── Arduino A2
```

**💡 使用提示**：
- 声音传感器可以检测环境噪音
- 可用于判断油烟机是否开启
- 灵敏度可通过传感器上的电位器调节

### 第六步：使用面包板整理接线

**使用面包板的好处**：
- 电源线统一管理
- 接线更整洁
- 便于检查和维护

**推荐接线方式**：

1. **电源总线**（面包板顶部）：
   ```
   Arduino 5V ──→ 面包板 + 总线
   Arduino GND ──→ 面包板 - 总线
   ```

2. **分配电源**（从面包板到传感器）：
   ```
   面包板 + 总线 ──→ 所有传感器的VCC
   面包板 - 总线 ──→ 所有传感器的GND
   ```

3. **信号线**（直接连接）：
   ```
   DHT11 DATA ──→ Arduino D2
   MQ7 A0 ────→ Arduino A0
   MQ135 A0 ───→ Arduino A1
   声音 OUT ───→ Arduino A2
   ```

---

## 接线图示

### 完整接线总览

```
┌─────────────────────────────────────────────────────────┐
│                  Arduino UNO R4 WiFi                    │
│                                                           │
│  [5V]──┬────→ DHT11(VCC)                               │
│        ├────→ MQ7(VCC)                                  │
│        ├────→ MQ135(VCC)                                │
│        └────→ 声音传感器(VCC)                          │
│                                                           │
│  [GND]─┬────→ DHT11(GND)                               │
│        ├────→ MQ7(GND)                                  │
│        ├────→ MQ135(GND)                                │
│        └────→ 声音传感器(GND)                          │
│                                                           │
│  [D2]────────→ DHT11(DATA)                              │
│  [A0]────────→ MQ7(A0)                                  │
│  [A1]────────→ MQ135(A0)                                │
│  [A2]────────→ 声音传感器(OUT)                         │
│                                                           │
│  [USB-C]─────→ 电脑 (供电 + 编程)                     │
└─────────────────────────────────────────────────────────┘
```

### 引脚分配表

| 传感器 | Arduino引脚 | 引脚类型 | 跳线颜色建议 |
|--------|-------------|----------|--------------|
| DHT11 温湿度 - VCC | 5V | 电源 | 红色 |
| DHT11 温湿度 - GND | GND | 电源 | 黑色 |
| DHT11 温湿度 - DATA | D2 | 数字 | 黄色 |
| MQ7 一氧化碳 - VCC | 5V | 电源 | 红色 |
| MQ7 一氧化碳 - GND | GND | 电源 | 黑色 |
| MQ7 一氧化碳 - A0 | A0 | 模拟 | 灰色 |
| MQ135 空气质量 - VCC | 5V | 电源 | 红色 |
| MQ135 空气质量 - GND | GND | 电源 | 黑色 |
| MQ135 空气质量 - A0 | A1 | 模拟 | 绿色 |
| 声音传感器 - VCC | 5V | 电源 | 红色 |
| 声音传感器 - GND | GND | 电源 | 黑色 |
| 声音传感器 - OUT | A2 | 模拟 | 蓝色 |

---

## Arduino代码配置

### 第一步：安装Arduino IDE

1. 下载并安装 [Arduino IDE 2.0+](https://www.arduino.cc/en/software)
2. 启动Arduino IDE

### 第二步：安装必要的库

打开Arduino IDE，进入 **工具 → 管理库**，搜索并安装：

1. **DHT sensor library** by Adafruit
2. **Adafruit Unified Sensor** by Adafruit

### 第三步：配置代码

打开 `experiment/air-monitor/src/arduino/kitchen_sensor_v1.ino`

**修改WiFi配置**（第14-15行）：
```cpp
char ssid[] = "你的WiFi名称";        // 修改为你的WiFi SSID
char pass[] = "你的WiFi密码";        // 修改为你的WiFi密码
```

**修改服务器地址**（第18行）：
```cpp
String host = "192.168.3.4";          // 修改为你的PC IP地址
```

**如何获取PC的IP地址**：

**Windows**:
```bash
ipconfig
# 查找 "无线局域网适配器 WLAN" 下的 IPv4 地址
```

**macOS/Linux**:
```bash
ifconfig
# 或
ip addr show
```

### 第四步：上传代码到Arduino

1. **选择开发板**：工具 → 开发板 → Arduino UNO R4 Boards → Arduino UNO R4 WiFi
2. **选择端口**：工具 → 端口 → 选择对应的COM端口（例如 COM3）
3. **上传代码**：点击上传按钮 ↑

**上传成功标志**：
```
上传成功
```

### 第五步：查看串口输出

1. 打开串口监视器：工具 → 串口监视器
2. 设置波特率：**115200**
3. 观察输出：
   ```
   厨房空气质量监测系统启动
   传感器配置:
     - DHT11: 温湿度传感器
     - MQ7: 一氧化碳传感器
     - MQ135: 空气质量传感器
     - 声音传感器
   正在连接WiFi: ...
   WiFi连接成功！
   IP地址: 192.168.x.x
   系统启动完成，开始监测...
   --- 传感器数据 ---
   温度: 25.3°C
   湿度: 60.2%
   一氧化碳: 15 ppm
   空气质量: 85 AQI
   声音强度: 42 %
   ----------------
   ```

---

## Python服务器配置

### 第一步：安装Python依赖

打开命令行，进入项目目录：

```bash
cd experiment/air-monitor/src/python
pip install flask flask-cors
```

### 第二步：启动Web服务器

```bash
python kitchen_web_server.py
```

**启动成功输出**：
```
============================================================
厨房空气质量监测系统 - Python Web服务器（多传感器版本）
============================================================
传感器支持:
  - DHT11: 温湿度传感器
  - MQ7: 一氧化碳传感器
  - MQ135: 空气质量传感器
  - 声音传感器
------------------------------------------------------------
服务器启动中...
Web界面访问地址: http://localhost:5000
API接口:
  - POST /api/sensor-data (Arduino发送数据)
  - GET  /api/current-data (获取当前数据)
  - GET  /api/history (获取历史数据)
  - GET  /api/stats (获取统计信息)
============================================================
 * Running on all addresses (0.0.0.0)
 * Running on http://127.0.0.1:5000
 * Running on http://192.168.3.4:5000
```

### 第三步：访问Web界面

**PC访问**：
```
http://localhost:5000
```

**手机访问**（同一WiFi网络）：
```
http://你的PC_IP:5000
例如: http://192.168.3.4:5000
```

---

## 测试验证

### 硬件检查清单

- [ ] **电源检查**
  - [ ] Arduino USB连接正常，指示灯亮起
  - [ ] 所有传感器VCC接5V
  - [ ] 所有传感器GND接地

- [ ] **信号线检查**
  - [ ] DHT11 DATA接D2
  - [ ] MQ7 A0接A0
  - [ ] MQ135 A0接A1
  - [ ] 声音传感器OUT接A2

- [ ] **连接牢固性**
  - [ ] 所有跳线插接牢固
  - [ ] 没有松动的连接
  - [ ] 没有短路现象

### 软件检查清单

- [ ] **Arduino端**
  - [ ] WiFi配置正确
  - [ ] 服务器IP配置正确
  - [ ] 代码上传成功
  - [ ] 串口输出正常
  - [ ] WiFi连接成功

- [ ] **Python服务器端**
  - [ ] Flask安装成功
  - [ ] 服务器启动正常
  - [ ] 端口5000可访问
  - [ ] 防火墙允许访问

### 功能测试

#### 1. 温湿度测试
- 对着DHT11传感器呼气，观察温度和湿度变化
- 预期：温度应升高1-2°C，湿度应明显增加

#### 2. 一氧化碳测试（MQ7）
- 注意：MQ7需要预热5分钟
- 可以用点燃的香烟或打火机（保持安全距离）测试
- 预期：数值应有明显上升

#### 3. 空气质量测试（MQ135）
- 对着传感器喷一点空气清新剂或香水
- 预期：AQI数值应快速上升

#### 4. 声音测试
- 拍手或播放音乐
- 预期：声音强度数值应跳动

#### 5. LED矩阵显示
- 观察Arduino上的LED矩阵
- 预期：循环显示温度、湿度、CO、空气质量

#### 6. Web界面测试
- 浏览器访问监控页面
- 预期：实时显示所有传感器数据
- 数值每3秒自动刷新
- 图表显示历史趋势

---

## 常见问题

### Q1: Arduino无法连接WiFi？

**可能原因**：
- WiFi名称或密码错误
- WiFi是5GHz频段（Arduino只支持2.4GHz）
- 信号太弱

**解决方法**：
1. 检查WiFi配置
2. 确认使用2.4GHz网络
3. 将Arduino靠近路由器
4. 检查串口输出的错误信息

### Q2: Python服务器无法接收数据？

**可能原因**：
- 防火墙阻止端口5000
- IP地址配置错误
- Arduino和PC不在同一网络

**解决方法**：
1. 关闭防火墙或允许端口5000
2. 检查PC的IP地址
3. 确认设备在同一WiFi网络
4. 检查Arduino串口输出，查看连接状态

### Q3: 传感器数据不准确？

**DHT11温湿度**：
- 传感器需要稳定环境
- 避免阳光直射
- 精度：温度±2°C，湿度±5%RH

**MQ7一氧化碳**：
- 需要预热5分钟以上
- 首次使用建议预热24小时
- 读数需要校准

**MQ135空气质量**：
- 需要预热时间
- 对多种气体敏感
- 数值是相对值，不是绝对值

**声音传感器**：
- 检查电位器设置
- 调整灵敏度

### Q4: LED矩阵不显示？

**检查项**：
1. 代码是否正确上传
2. 串口输出是否正常
3. 传感器数据是否读取成功

### Q5: Web界面显示"连接失败"？

**检查项**：
1. Python服务器是否正在运行
2. 浏览器控制台是否有错误
3. 网络连接是否正常
4. 访问地址是否正确

### Q6: 数据不更新？

**检查项**：
1. Arduino是否正常运行（查看串口输出）
2. 数据是否成功发送（查看串口日志）
3. Python服务器是否收到数据（查看服务器日志）
4. 浏览器自动刷新是否开启

### Q7: 如何校准传感器？

**MQ7和MQ135校准**：
1. 在干净空气中预热24小时
2. 记录基准值
3. 在代码中调整映射范围
4. 使用已知浓度的气体进行对比校准

---

## 安全注意事项

### ⚠️ 使用警告

1. **电气安全**
   - 不要在有水的环境中操作
   - 确保电源稳定
   - 避免短路

2. **传感器安全**
   - MQ7和MQ135工作时会发热
   - 不要触摸传感器加热部分
   - 保持通风

3. **测试安全**
   - 测试气体传感器时保持通风
   - 不要使用易燃易爆气体
   - 保持安全距离

4. **数据准确性**
   - 本系统仅供学习和演示
   - 不能作为专业安全监测设备
   - 重要场合请使用专业设备

---

## 进阶优化

### 硬件优化

1. **电源优化**
   - 使用外部5V电源（2A以上）
   - 添加电源滤波电容
   - 使用电源模块稳定供电

2. **接线优化**
   - 使用PCB板代替面包板
   - 焊接连接提高稳定性
   - 添加外壳保护

3. **传感器扩展**
   - 添加PM2.5传感器
   - 添加甲烷传感器（MQ4）
   - 添加光照传感器

### 软件优化

1. **数据处理**
   - 添加数据平滑算法
   - 实现传感器校准功能
   - 添加异常数据过滤

2. **功能扩展**
   - 添加阈值告警
   - 添加邮件/短信通知
   - 添加数据导出功能
   - 接入云平台

3. **界面优化**
   - 添加更多图表类型
   - 实现数据对比分析
   - 添加移动端APP

---

## 总结

通过本组装指南，您应该能够：

✅ 正确连接所有传感器到Arduino  
✅ 配置并上传Arduino代码  
✅ 启动Python Web服务器  
✅ 通过浏览器查看实时监控数据  
✅ 进行基本的故障排查  

这个项目展示了完整的物联网系统架构：
- **硬件层**：Arduino + 多种传感器
- **网络层**：WiFi数据传输
- **应用层**：Python Web服务器
- **展示层**：现代化Web界面

**下一步**：
- 尝试不同环境下的测试
- 分析历史数据趋势
- 根据需求进行功能扩展

**技术支持**：
- 查看项目文档：`experiment/air-monitor/README.md`
- 查看视频剧本：`experiment/air-monitor/docs/视频剧本.md`
- 参考Arduino代码注释

---

**文档版本**: v1.0  
**最后更新**: 2025-10-28  
**维护者**: 项目团队

