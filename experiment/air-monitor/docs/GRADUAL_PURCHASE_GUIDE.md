# 渐进式采购指南

## 🎯 概述

支持你逐步采购传感器，代码会正常运行，缺少的传感器数据会显示为"未获取"。

---

## ✅ 第一阶段：使用现有传感器开始实验

### 已有的传感器（立即可用）

| 传感器 | 来源 | 状态 |
|--------|------|------|
| **DHT11** 温湿度 | 套件 | ✅ 可用 |
| **声音传感器** 噪音 | 套件 | ✅ 可用 |
| **MQ-135** 空气质量 | 图片中的套件 | 根据实际情况 |
| **MQ-7** 一氧化碳 | 图片中的套件 | 根据实际情况 |

### 启动代码会做什么？

1. **自动检测传感器**
   - 启动时会检测哪些传感器已连接
   - 在串口监视器显示检测结果

2. **正常工作**
   - 已连接的传感器正常读取数据
   - 未连接的传感器标记为"未获取"

3. **发送数据**
   - 所有数据（包括null）都会发送到PC服务器
   - Web界面会正确显示"未获取"的状态

---

## 📊 传感器状态显示

### 启动时会看到：

```
检测传感器状态...

✓ DHT11: 可用（套件包含）
✓ 声音传感器: 可用（套件包含）
✓ MQ-135 (空气质量): 已连接
✗ MQ-7 (一氧化碳): 未连接（需购买）
✗ PMS5003 (PM2.5): 未连接（第2阶段采购）

传感器状态汇总：
┌─────────────────────┬──────────┐
│ 传感器              │ 状态     │
├─────────────────────┼──────────┤
│ DHT11 (温湿度)      │  可用 ✓  │
│ 声音传感器          │  可用 ✓  │
│ MQ-135 (空气质量)     │  可用 ✓  │
│ MQ-7 (一氧化碳)     │ 未安装 ✗  │
│ PMS5003 (PM2.5)     │ 第2阶段  │
│ HC-SR501 (人体感应) │ 可选     │
└─────────────────────┴──────────┘
```

### 数据输出示例：

```
----------------
温度(DHT11): 23.5°C
湿度: 55.2%
气压: N/A (DHT11不支持)
MQ135(CO2): 345
MQ7(一氧化碳): 未获取（需购买传感器）
PM2.5: 未获取（第2阶段采购PMS5003）
声音模拟: 250  声音数字: 无
人体感应: 无活动
```

---

## 🔌 接线说明（第1阶段）

### 最少配置（确保能运行）

如果你暂时**不买任何传感器**，只使用套件中已有的：

```
Arduino UNO R4 WiFi
├── 5V
├── GND
│
├── D2 ───→ DHT11 DATA
│
├── A2 ───→ 声音传感器 AO
└── D5 ───→ 声音传感器 DO
```

**能监测的指标：**
- ✅ 温度
- ✅ 湿度
- ✅ 噪音
- ❌ 空气质量（未购买）
- ❌ PM2.5（未购买）

### 标准配置（第1阶段）

如果你已有图中的MQ传感器：

```
Arduino UNO R4 WiFi
├── D2 ───→ DHT11 DATA
├── A0 ───→ MQ-135 AO
├── A1 ───→ MQ-7 AO
├── A2 ───→ 声音传感器 AO
└── D5 ───→ 声音传感器 DO
```

**能监测的指标：**
- ✅ 温度
- ✅ 湿度
- ✅ 空气质量（MQ-135）
- ✅ 一氧化碳（MQ-7）
- ✅ 噪音
- ❌ PM2.5（第2阶段采购）

---

## 📋 数据格式

### JSON数据示例（第1阶段）

```json
{
  "temperature": 23.5,
  "humidity": 55.2,
  "pressure": null,
  "mq135_value": 345,
  "mq7_value": null,
  "pm25": null,
  "pm10": null,
  "sound_analog": 250,
  "sound_detected": false,
  "motion_detected": false,
  "timestamp": 123456789,
  "device_id": "kitchen_monitor_kit_001"
}
```

**说明：**
- 有数据的显示数值
- 未购买的传感器显示`null`
- Web界面会自动识别null并显示"未获取"或"-"

---

## 🚀 开始使用

### 步骤1：上传代码

1. 打开 `src/arduino/kitchen_sensor_with_existing_kit.ino`
2. 修改WiFi配置
3. 上传到Arduino

### 步骤2：查看串口输出

打开串口监视器（波特率115200），你会看到：

```
=================================
厨房环境监测系统（套件版-渐进式）启动
=================================

检测传感器状态...

✓ DHT11: 可用（套件包含）
✓ 声音传感器: 可用（套件包含）
...
```

### 步骤3：发送数据到服务器

代码会自动：
- 检测已连接的传感器
- 读取可用数据
- 未购买的传感器返回null
- 发送到PC服务器

### 步骤4：查看Web界面

访问 `http://localhost:5000`

**会看到：**
- ✅ 温度：23.5°C（有数据）
- ✅ 湿度：55.2%（有数据）
- ✅ 噪音：有数据
- ❌ 空气质量：未获取（如果你没买MQ-135）
- ❌ PM2.5：未获取（第2阶段）

---

## 💰 采购时间表

### 第1阶段（现在就可以开始）

**已有：**
- ✅ DHT11（套件）
- ✅ 声音传感器（套件）
- ❓ MQ-135/MQ-7（根据你的套件情况）

**实验目标：**
- 监测温度湿度变化
- 监测噪音变化
- 如果有MQ传感器，监测空气质量和CO

**采购清单：**
- 根据需要决定是否购买MQ-135和MQ-7

---

### 第2阶段（建议尽快采购）

**新增采购：**
- 🔴 **PMS5003** - ¥45

**采购原因：**
- PM2.5是油烟监测的核心指标
- 完成完整实验需要此传感器

**采购后可监测：**
- ✅ 所有第1阶段的指标
- ✅ **PM2.5颗粒物浓度**（新增）
- ✅ PM10颗粒物浓度（新增）

---

### 第3阶段（可选）

**新增采购：**
- HC-SR501 人体感应传感器 - ¥6

**作用：**
- 检测厨房是否有人活动
- 区分有人/无人的数据

---

## 📊 实验数据示例

### 第1阶段实验（无PMS5003）

| 时间 | 场景 | 温度 | 湿度 | MQ-135 | MQ-7 | PM2.5 |
|------|------|------|------|--------|------|-------|
| 00:00 | 正常 | 22°C | 55% | 200 | - | **未获取** |
| 00:10 | 炒菜 | 38°C | 75% | 450 | 80 | **未获取** |

**分析：**
- ✅ 可以分析温度、湿度、空气质量变化
- ❌ 无法分析PM2.5变化（最关键的指标）

---

### 第2阶段实验（有PMS5003）

| 时间 | 场景 | 温度 | 湿度 | MQ-135 | PM2.5 |
|------|------|------|------|--------|-------|
| 00:00 | 正常 | 22°C | 55% | 200 | 25 |
| 00:10 | 炒菜 | 38°C | 75% | 450 | **280** |
| 00:15 | 开启抽油烟机 | 33°C | 68% | 350 | **85** |

**分析：**
- ✅ 完整的数据对比
- ✅ 可以看到PM2.5从25→280→85的完整变化
- ✅ 可以分析抽油烟机的效果

---

## ⚠️ 重要提示

### 实验建议

1. **第1阶段可以先开始**
   - 至少可以验证系统正常工作
   - 可以先分析温湿度和噪音

2. **但第2阶段强烈推荐尽快采购**
   - PMS5003是核心指标
   - 没有PM2.5数据实验就不完整

3. **建议的采购顺序**
   - 第1天：购买PMS5003（¥45）
   - 或者：先用现有传感器做第1阶段实验
   - 然后：第2周采购PMS5003，做完整实验

---

## ✅ 总结

### 你现在可以：

1. **立即开始实验** - 使用已有传感器
2. **代码正常运行** - 缺少的传感器显示"未获取"
3. **逐步采购** - 随时添加新传感器
4. **自动适配** - 代码自动检测并启用新传感器

### 推荐行动：

1. **今天**：上传代码，测试现有传感器
2. **本周内**：采购PMS5003（¥45）
3. **下周**：完成完整实验

**总采购成本：仅¥45**（只需要PMS5003）

---

**创建日期**: 2025-01-XX  
**版本**: v2.0 - 支持渐进式采购  
**状态**: ✅ 可以立即开始实验

